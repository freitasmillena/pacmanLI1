<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Tarefa2</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption empty">&nbsp;</span><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Maria Pinheiro &lt;mcardosorp@gmail.com&gt;;<br />Millena Santos &lt;freitasmillena27@gmail.com&gt;</td></tr><tr><th>Safe Haskell</th><td>Safe</td></tr></table><p class="caption">Tarefa2</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Um m&#243;dulo Haskell que determina o efeito de uma jogada no estado do jogo dada a descri&#231;&#227;o do estado do jogo e a jogada de um dos jogadores </p><h1>Introdu&#231;&#227;o</h1><p>A tarefa 2 &#233; a tarefa onde todas as jogadas s&#227;o aplicadas a um estado de jogo. &#201; nesta tarefa que se possibilita que os fantasmas e o pacman consigam realizar as jogadas. Quando dado um estado de jogo e uma jogada de um dos jogadores, o resultado ser&#225; um novo estado de jogo que ir&#225; incluir a atualiza&#231;&#227;o do labirinto consuante a jogada realizada, e a atualiza&#231;&#227;o de todos os estados dos jogadores como consequ&#234;ncia da jogada realizada.</p><h1>Objetivo </h1><h2><em>Fase 1</em></h2><p>O nosso objetivo final desta tarefa era conseguir com que fosse poss&#237;vel realizar jogadas com o pacman, com o menor n&#250;mero de bugs poss&#237;vel e seguindo as regras contidas no enunciado. </p><p>Em rela&#231;&#227;o ao processamento da jogada, esta deve ser efetuada considerando que:</p><ul><li>Se a <strong>jogada tiver uma orienta&#231;&#227;o diferente</strong> da orienta&#231;&#227;o do jogador, este &#250;ltimo apenas <strong>altera a sua orienta&#231;&#227;o</strong> para a desejada e permanece nas mesmas coordenadas. </li><li>Caso contr&#225;rio, se poss&#237;vel, ou seja, caso <strong>n&#227;o exista uma parede (Wall)</strong>, o jogador deve movimentar-se e <strong>alterar as suas coordenadas</strong> consuante a jogada desejada. </li></ul><p>As a&#231;&#245;es induzidas pelas a&#231;&#245;es realizadas depende do tipo de pe&#231;a existente nas coordenadas para qual a jogada leva o jogador:</p><ul><li>Se n&#227;o existe <strong>nenhuma pe&#231;a</strong>, <strong>nada acontece</strong></li><li>Se existir uma <strong>comida pequena</strong>, a pontua&#231;&#227;o do jogador dever&#225; ser atualizada com <strong>+1 ponto</strong>;</li><li>Se existir uma <strong>comida grande</strong>, a pontua&#231;&#227;o do jogador dever&#225; ser atualizada com <strong>+5 pontos</strong> e o estado do jogador tamb&#233;m dever&#225; ser alterado para <strong>Mega</strong>. Considerando que o estado do pacman se altera para o Mega, todos os <strong>fantasmas</strong> existintes no labirinto alteram o seu estado para <strong>Dead</strong> e diminuem a sua <strong>velocidade para metade</strong>.</li><li><p>Se existir um fantasma vivo <strong>(Alive)</strong>,</p><ol><li>Caso o jogador ainda tenha vidas, deve perder uma vida.</li><li>Caso contr&#225;rio, o jogador deve atualizar o seu estado para Dying.</li></ol></li><li>Se existir um fantasma morto <strong>(Dead)</strong>, o jogador deve &#8220;comer&#8221; o fantasma e a pontua&#231;&#227;o do mesmo dever&#225; ser atualizada com <strong>+10 pontos</strong>. Quando os <strong>fantasmas</strong> s&#227;o &quot;comidos&quot; devem <strong>voltar &#224; casa dos fantasmas</strong> e voltar a ficarem vivos, ou seja, o seu estado tem que ser alterado para <strong>Alive</strong>.</li><li>Se existir um espa&#231;o vazio junto ao limite do labirinto, o que vai corresponder a um <strong>t&#250;nel</strong>, pelo que, o <strong>jogador deve ser transportado para o lado oposto do labirinto</strong>.</li></ul><h2><em>Fase 2</em></h2><p>Consuante o enunciado da segunda fase tivemos que acrescentar algumas condi&#231;&#245;es a esta tarefa. As modifica&#231;&#245;es feitas nesta fase t&#234;m o objetivo de fazer com que os fantasmas tamb&#233;m possam efetuar jogadas e acrescentar a passagem do tempo &#224;s jogadas realizadas para a tarefa 4, e foram feitas seguindo as regras contidas no enunciado:</p><ul><li>A <strong>boca do Pacman deve abrir e fechar</strong> alternadamente entre cada jogada;</li><li>Se o <strong>Pacman</strong> estiver em estado o <strong>Mega</strong>, o tempo mega <strong>(timeMega) deve sofrer aletra&#231;&#245;es</strong> em cada jogada;</li><li>Se o <strong>Pacman</strong> estiver em estado o <strong>Mega</strong> e se o tempo mega <strong>(timeMega) for &lt;=0</strong>, o mesmo deve voltar ao estado <strong>Alive</strong>;</li><li>Se n&#227;o existir um Pacman em modo <strong>Mega</strong>, os fantasmas devem voltar ao estado <strong>Alive</strong>; </li></ul><h1>Discuss&#227;o e conclus&#227;o</h1><p>Esta tarefa foi realizada seguindo as indica&#231;&#245;es indicadas no enunciado. Juntamos o necess&#225;rio para conseguir realizar cada jogada com sucesso, tentado cumprir as condi&#231;&#245;es definidas no m&#225;ximo de cen&#225;rios poss&#237;vel. Isto &#233;, tentamos n&#227;o limitar o funcionamento do nosso jogo a mapas ou situa&#231;&#245;es espec&#237;ficas mas sim a todo o tipo de situa&#231;&#245;es com que nos deparamos. Tamb&#233;m foi uma &#243;tima tarefa para perceber melhor sobre o jogo e sobre os tipos que nos forneceram.</p><p>Em conclus&#227;o, ficamos bastante felizes com o resultado final desta tarefa. Ap&#243;s a segunda fase do trabalho, quando tivemos que tornar esta tarefa mais rica, tivemos a oportunidade de corrigir erros que faziam com que nem todas as possibilidades fossem levadas em considera&#231;&#227;o ou que n&#227;o cumpriam o que era suposto. Portanto, foi um grande desafio levando em conta a quantidade de possibilidades. Tivemos que, al&#233;m de estudar o jogo, utilizar nossa imagina&#231;&#227;o.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:movePlay">movePlay</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:moveAfterGhostSide">moveAfterGhostSide</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:moveAfterGhostVertical">moveAfterGhostVertical</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:stateMega">stateMega</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:isthereGhost-39-">isthereGhost'</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool</li><li class="src short"><a href="#v:collideGhostSide">collideGhostSide</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:collideGhostVertical">collideGhostVertical</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:movePlayerSide">movePlayerSide</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:movePlayerVertical">movePlayerVertical</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:changeOrientation">changeOrientation</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:idpieceCorridor">idpieceCorridor</a> :: <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a></li><li class="src short"><a href="#v:idpieceCoord">idpieceCoord</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a></li><li class="src short"><a href="#v:corridorChangePiece">corridorChangePiece</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>]</li><li class="src short"><a href="#v:changePieces">changePieces</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:updateMaze">updateMaze</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a></li><li class="src short"><a href="#v:coordA">coordA</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Int -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:coordB">coordB</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Int -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:ghostHome">ghostHome</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:findPlayer">findPlayer</a> :: Int -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:updateState">updateState</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:getPlayers">getPlayers</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:getCoords">getCoords</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:findPlayerCoord">findPlayerCoord</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:findPlayerscoord">findPlayerscoord</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:pacMode">pacMode</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:PacMode" title="Types">PacMode</a></li><li class="src short"><a href="#v:isitGhost">isitGhost</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; Bool</li><li class="src short"><a href="#v:isthereGhost">isthereGhost</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Bool</li><li class="src short"><a href="#v:istherePac">istherePac</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Bool</li><li class="src short"><a href="#v:nextCoord">nextCoord</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a></li><li class="src short"><a href="#v:istherePlayer">istherePlayer</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool</li><li class="src short"><a href="#v:stateGhost">stateGhost</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:ghostDead">ghostDead</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:ghostAlive">ghostAlive</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:getGhosts">getGhosts</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>]</li><li class="src short"><a href="#v:updatePlayersGhosts">updatePlayersGhosts</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:newState">newState</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:isitFood">isitFood</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Bool</li><li class="src short"><a href="#v:pacPlay">pacPlay</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:play">play</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:playGhost">playGhost</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a></li><li class="src short"><a href="#v:movePlayGhost">movePlayGhost</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:moveAfterPacSide">moveAfterPacSide</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:moveAfterPacVertical">moveAfterPacVertical</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:istherePacman">istherePacman</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool</li><li class="src short"><a href="#v:getPacman">getPacman</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:ghostHome-39-">ghostHome'</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:collidePac">collidePac</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li><li class="src short"><a href="#v:openOrClosed">openOrClosed</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:movePlay" class="def">movePlay</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:movePlay" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dada uma jogada, um labirinto e uma lista de jogadores, devolve o jogador de ID j atualizado</p><pre>if o == getPlayerOrientation (findPlayer j (p:ps)) then  case o of 
                                     R -&gt; moveAfterGhostSide (Move j o) (x:xs) (p:ps) 1 R
                                     L -&gt; moveAfterGhostSide (Move j o) (x:xs) (p:ps) (-1) L
                                     U -&gt; moveAfterGhostVertical (Move j o) (x:xs) (p:ps) (-1) U
                                     D -&gt; moveAfterGhostVertical (Move j o) (x:xs) (p:ps) 1 D
else changeOrientation (Move j o) (x:xs) (findPlayer j (p:ps)) o
</pre><ul><li>A primeira condi&#231;&#227;o testa se a orienta&#231;&#227;o recebida na jogada &#233; a mesma que o jogador possui</li><li>Se for aplica a fun&#231;&#227;o de acordo com a orienta&#231;&#227;o horizontal ou vertical</li><li>Caso contr&#225;rio muda apenas a orienta&#231;&#227;o do jogador para a orienta&#231;&#227;o desejada da jogada</li></ul></div></div><div class="top"><p class="src"><a id="v:moveAfterGhostSide" class="def">moveAfterGhostSide</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:moveAfterGhostSide" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador, um inteiro e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es para <strong>esquerda</strong> e <strong>direita</strong> </p><pre>if isthereGhost' (p:ps) (a,b) == True
</pre><ul><li>A fun&#231;&#227;o analisa se, nas coordenadas para onde a jogada pretende mover o pacman existe um fantasma. </li></ul><pre>if idpieceCoord (x:xs) (a,b) == Food Big then collideGhostSide mega i ori
else collideGhostSide (findPlayer j (p:ps)) i ori
</pre><ul><li>Se existir um fantasma, entra outra condi&#231;&#227;o para saber se existe <strong>Food Big</strong> nas coordenadas que o jogador pretende ir, caso exista &#233; invocada a fun&#231;&#227;o que movimenta o pacman consuante a colis&#227;o com o mesmo, sendo que se utiliza a fun&#231;&#227;o stateMega para alterar o estado do pacman para Mega . </li><li>Caso n&#227;o exista <strong>Food Big</strong>, &#233; invocada a fun&#231;&#227;o que movimenta o pacman consuante a colis&#227;o com um fantasma</li></ul><pre>else movePlayerSide (Move j o) (x:xs) (findPlayer j (p:ps)) i ori 
</pre><ul><li>Se n&#227;o existir, &#233; invocada a fun&#231;&#227;o que movimenta o pacman consuante a pe&#231;a que existe nessas coordenadas</li></ul><pre>where (a,b) = coordB (getCoords (findPlayer j (p:ps))) i
</pre><ul><li>Coordenada que o jogador pretende ir</li></ul></div></div><div class="top"><p class="src"><a id="v:moveAfterGhostVertical" class="def">moveAfterGhostVertical</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:moveAfterGhostVertical" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador, um inteiro e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es para <strong>cima</strong> e <strong>baixo</strong> </p><ul><li>A fun&#231;&#227;o tem o mesmo objetivo da fun&#231;&#227;o <strong>moveAfterGhostSide</strong> por&#233;m para jogadas na vertical </li></ul></div></div><div class="top"><p class="src"><a id="v:stateMega" class="def">stateMega</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:stateMega" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um player pacman altera o estado do pacman para Mega e altera o timeMega para 10 sem alterar as suas coordenadas </p></div></div><div class="top"><p class="src"><a id="v:isthereGhost-39-" class="def">isthereGhost'</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool <a href="#v:isthereGhost-39-" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se &#7869;xiste um player com esta coodernada e, se houver, verifica se &#233; fantasma</p></div></div><div class="top"><p class="src"><a id="v:collideGhostSide" class="def">collideGhostSide</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:collideGhostSide" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o quando o pacman colide com um fantasma. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es <strong>esquerda</strong> e <strong>direita</strong></p><pre>if pacmanMode /= Mega
</pre><ul><li>A fun&#231;&#227;o analisa se o pacman est&#225; em estado Mega</li></ul><pre>if lifes == 0 then (Pacman (PacState (id, (a,b+i), v, ori, points, lifes) timeMega openClosed Dying))
else (Pacman (PacState (id, (a,b+i), v, ori, points, lifes -1) timeMega openClosed pacmanMode))
</pre><ul><li>Em caso negativo, o pacman perde 1 vida (no caso de ter 0 vidas o pacman morre)</li></ul><pre>else (Pacman (PacState (id, (a,b+i), v, ori, points+10, lifes) timeMega openClosed pacmanMode))  
</pre><ul><li>Caso contr&#225;rio, o pacman come o fantasma e ganha 10 pontos. </li></ul></div></div><div class="top"><p class="src"><a id="v:collideGhostVertical" class="def">collideGhostVertical</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:collideGhostVertical" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o quando o pacman colide com um fantasma. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es <strong>cima</strong> e <strong>baixo</strong></p><ul><li>A fun&#231;&#227;o tem o mesmo objetivo da fun&#231;&#227;o <strong>collideGhostSide</strong> por&#233;m para jogadas na vertical </li></ul></div></div><div class="top"><p class="src"><a id="v:movePlayerSide" class="def">movePlayerSide</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:movePlayerSide" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador, um inteiro e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es para <strong>esquerda</strong> e <strong>direita</strong></p><pre>case idpieceCoord (x:xs) (a,b+i) of
</pre><ul><li>A fun&#231;&#227;o analisa qual a pe&#231;a que se encontra nas coordenadas para onde a jogada pretende mover o pacman</li></ul><pre>Wall -&gt; (Pacman (PacState (j, (a,b), v, ori, points, lifes) timeMega openClosed pacmanMode))
</pre><ul><li>Se existir uma parede, o pacman fica igual</li></ul><pre>Food Big -&gt; (Pacman (PacState (j, (a,b+i), v, ori, points + 5, lifes) 10 openClosed Mega))
</pre><ul><li>Se existir uma Food Big, o pacman ganha 5 pontos, o timeMega altera para 10, e o seu estado altera para Mega. A&#314;&#233;m disto, as suas coordenadas alteram consuante a orienta&#231;&#227;o que este se move.</li></ul><pre>Food Little -&gt; (Pacman (PacState (j, (a,b+i), v, ori, points + 1, lifes) timeMega openClosed pacmanMode))
</pre><ul><li>Se existir uma Food Little, o pacman ganha 1 ponto, e as coordenadas do mesmo alterma consoante a orienta&#231;&#227;o que este se move</li></ul><pre>Empty -&gt; if o == R then 
      if (a,b) == (a,(length x)-1)
      then (Pacman (PacState (j, (a,0), v, ori, points, lifes) timeMega openClosed pacmanMode))
      else (Pacman (PacState (j, (a,b+i), v, ori, points, lifes) timeMega openClosed pacmanMode))
else 
      if (a,b) == (a,0) 
      then (Pacman (PacState (j, (a,(length x)-1), v, ori, points, lifes) timeMega openClosed pacmanMode))
      else (Pacman (PacState (j, (a,b+i), v, ori, points, lifes) timeMega openClosed pacmanMode))
</pre><ul><li>Se existir Empty, verifica se &#233; apenas um espa&#231;o vazio ou se &#233; um t&#250;nel</li><li>Caso seja um t&#250;nel, o jogador &#233; transportado para o outro lado do labirinto por este t&#250;nel</li><li>Caso contr&#225;rio, apenas se alteram as suas coordenadas consuante a jogada</li></ul></div></div><div class="top"><p class="src"><a id="v:movePlayerVertical" class="def">movePlayerVertical</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:movePlayerVertical" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador, um inteiro e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es para <strong>cima</strong> e <strong>baixo</strong></p><ul><li>A fun&#231;&#227;o tem o mesmo objetivo da fun&#231;&#227;o <strong>movePlayerSide</strong> por&#233;m para jogadas na vertical, com a exce&#231;&#227;o de quando a pe&#231;a &#233; <strong>Empty</strong>, pois neste tipo de jogadas o jogador n&#227;o consegue aceder aos t&#250;neis, devido ao labirinto ser limitado lateralmente por paredes.</li></ul></div></div><div class="top"><p class="src"><a id="v:changeOrientation" class="def">changeOrientation</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:changeOrientation" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Neste caso o jogador apenas muda a orienta&#231;&#227;o e <strong>n&#227;o</strong> avan&#231;a no labirinto, pelo que apenas muda a <strong>orienta&#231;&#227;o</strong> para a desejada.</p></div></div><div class="top"><p class="src"><a id="v:idpieceCorridor" class="def">idpieceCorridor</a> :: <a href="Types.html#t:Corridor" title="Types">Corridor</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> <a href="#v:idpieceCorridor" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um corredor e uma coordenada, devolve a pe&#231;a equivalente </p></div></div><div class="top"><p class="src"><a id="v:idpieceCoord" class="def">idpieceCoord</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Piece" title="Types">Piece</a> <a href="#v:idpieceCoord" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um labirinto e uma coordenada, devolve a pe&#231;a correspondente </p></div></div><div class="top"><p class="src"><a id="v:corridorChangePiece" class="def">corridorChangePiece</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>] <a href="#v:corridorChangePiece" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que seleciona o corredor de um labirinto equivalente &#224;s coordenadas dadas </p></div></div><div class="top"><p class="src"><a id="v:changePieces" class="def">changePieces</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Piece" title="Types">Piece</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:changePieces" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um labirinto, um corredor e uma coordenada troca a pe&#231;a equivalente por <strong>Empty</strong></p><pre>superiormaze = fst (splitAt a (x:xs))
</pre><ul><li>Divide o labirinto verticalmente quando encontra o corredor relativo &#224; posi&#231;&#227;o <strong>a</strong> e seleciona o primeiro corredor desta lista </li></ul><pre>inferiormaze = tail (snd (splitAt a (x:xs)))
</pre><ul><li>Divide o labirinto verticalmente quando encontra o corredor relativo &#224; posi&#231;&#227;o <strong>a</strong>, seleciona a segunda lista de listas e desta lista retorna apenas a tail</li></ul><pre>corridorChange = [fst (splitAt b (head (snd (splitAt a (x:xs))))) ++ [Empty] ++ tail (snd (splitAt b (head (snd (splitAt a (x:xs))))))]
</pre><ul><li>A primeira parte: Divide o labirinto verticalmente quando encontra o corredor relativo &#224; posi&#231;&#227;o <strong>a</strong>, seleciona a segunda lista de listas e desta lista retorna apenas a head. Com isto divide horizontalmente esta lista quando atinge a posi&#231;&#227;o relativa a <strong>b</strong> e por fim retorna a primeira lista de listas.</li><li>Adiciona a pe&#231;a <strong>Empty</strong> </li><li>A ultima parte: Divide o labirinto verticalmente quando encontra o corredor relativo &#224; posi&#231;&#227;o <strong>a</strong>, seleciona a segunda lista de listas e desta lista retorna apenas a head. Com isto divide horizontalmente esta lista quando atinge a posi&#231;&#227;o relativa a <strong>b</strong> e por fim retorna a segunda lista de listas.</li></ul></div></div><div class="top"><p class="src"><a id="v:updateMaze" class="def">updateMaze</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> <a href="#v:updateMaze" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que altera o labirinto caso a posi&#231;&#227;o ap&#243;s a jogada tenha comida pequena ou comida grande</p></div></div><div class="top"><p class="src"><a id="v:coordA" class="def">coordA</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Int -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> <a href="#v:coordA" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um par de coordenadas, devolve um par de coordenadas, alterando-o consuante a orienta&#231;&#227;o da jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es para <strong>esquerda</strong> e <strong>direita</strong></p></div></div><div class="top"><p class="src"><a id="v:coordB" class="def">coordB</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Int -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> <a href="#v:coordB" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um par de coordenadas, devolve um par de coordenadas, alternando-o consuante a orienta&#231;&#227;o da jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o &#224;s orienta&#231;&#245;es para <strong>cima</strong> e <strong>baixo</strong></p></div></div><div class="top"><p class="src"><a id="v:ghostHome" class="def">ghostHome</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:ghostHome" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que move os fantasmas comidos de volta para a casa dos fantasmas e voltam a estar vivos</p><pre>if even (length (x:xs))
</pre><ul><li>Foi necess&#225;rio separar condi&#231;&#245;es para quando a altura &#233; par ou &#237;mpar, pois o local onde os fantasmas se encontram na casa de fantasmas muda</li></ul><pre>(middleMaze (x:xs)+n,middleWidth (x:xs))
</pre><ul><li>Caso seja altura par, o n = 0 e caso seja altura &#237;mpar o n=1</li></ul></div></div><div class="top"><p class="src"><a id="v:findPlayer" class="def">findPlayer</a> :: Int -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:findPlayer" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado o ID identifica o estado do jogador desejado para realizar a jogada</p></div></div><div class="top"><p class="src"><a id="v:updateState" class="def">updateState</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> <a href="#v:updateState" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que atualiza o estado ao substituir o estado do jogador ap&#243;s sua jogada</p><pre>if id == getPlayerID p then (State (x:xs) (player:ps) l)
else (State (x:xs) (p : playersatt) l) 
</pre><pre>playersatt = (getPlayers (updateState (State (x:xs) ps l) player))
</pre><ul><li>Se o id do jogador for igual ao id do primeiro jogador da lista, ent&#227;o troca-se o estado do primeiro jogador da lista pelo mais atualizado</li><li>Caso contr&#225;rio, repete-se o primeiro jogador da lista e procura o jogador no resto da lista</li><li>A mesma coisa &#233; feita para os fantasmas</li></ul></div></div><div class="top"><p class="src"><a id="v:getPlayers" class="def">getPlayers</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:getPlayers" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um State, devolve a lista de jogadores</p></div></div><div class="top"><p class="src"><a id="v:getCoords" class="def">getCoords</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> <a href="#v:getCoords" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que extrai as coordenadas de um jogador</p></div></div><div class="top"><p class="src"><a id="v:findPlayerCoord" class="def">findPlayerCoord</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:findPlayerCoord" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que retorna o jogador com a coordenada pedida</p></div></div><div class="top"><p class="src"><a id="v:findPlayerscoord" class="def">findPlayerscoord</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:findPlayerscoord" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que retorna lista de jogadores com a coordenada pedida</p></div></div><div class="top"><p class="src"><a id="v:pacMode" class="def">pacMode</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:PacMode" title="Types">PacMode</a> <a href="#v:pacMode" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que retorna o pacmode </p></div></div><div class="top"><p class="src"><a id="v:isitGhost" class="def">isitGhost</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; Bool <a href="#v:isitGhost" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que confirma se um player &#233; ou n&#227;o um fantasma</p></div></div><div class="top"><p class="src"><a id="v:isthereGhost" class="def">isthereGhost</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Bool <a href="#v:isthereGhost" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma lista de jogada, um labirinto e uma lista de jogadores confirma se h&#225; ou n&#227;o jogador com esta coordenada na lista. Caso exista, confirma-se se o jogador &#233; ou n&#227;o um fantasma</p><pre>isitGhost (findPlayerCoord (p:ps) coord)
</pre><ul><li>Caso haja jogador com as coordenadas ap&#243;s a jogada, confirma se &#233; um fantasma</li></ul><pre>coord = getCoords (movePlay (Move j o) (x:xs) (p:ps))
</pre><ul><li>Seleciona as coordenadas do jogador ap&#243;s a jogada que ele pretende efetuar</li></ul></div></div><div class="top"><p class="src"><a id="v:istherePac" class="def">istherePac</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Bool <a href="#v:istherePac" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma lista de jogada, um labirinto e uma lista de jogadores confirma se h&#225; ou n&#227;o jogador com esta coordenada na lista. Caso exista, confirma-se se o jogador &#233; ou n&#227;o um pacman</p></div></div><div class="top"><p class="src"><a id="v:nextCoord" class="def">nextCoord</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> <a href="#v:nextCoord" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:istherePlayer" class="def">istherePlayer</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool <a href="#v:istherePlayer" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma lista de jogadores e uma coordenada, confirma se h&#225; ou n&#227;o jogador com esta coordenada na lista</p></div></div><div class="top"><p class="src"><a id="v:stateGhost" class="def">stateGhost</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:stateGhost" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um labirinto e dois jogadores, um pacman e um ghost, atualiza o estado do ghost consuante o estado do pacman</p><pre>if pacmanMode == Mega then ghostHome (x:xs) ghost
else ghost 
</pre><ul><li>Se o pacman estiver em estado Mega, aplica a fun&#231;&#227;o ghostHome ao fantasma, para que volte para a casa de fantasmas e vivo</li><li>Caso contr&#225;rio, o ghost permanece inalterado</li></ul></div></div><div class="top"><p class="src"><a id="v:ghostDead" class="def">ghostDead</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:ghostDead" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe uma lista s&#243; com fantasmas e muda os ghostModes para Dead e suas velocidades reduzidas para a metade</p></div></div><div class="top"><p class="src"><a id="v:ghostAlive" class="def">ghostAlive</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:ghostAlive" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe uma lista s&#243; com fantasmas e muda os ghostModes para Alive e suas velocidades para o normal</p></div></div><div class="top"><p class="src"><a id="v:getGhosts" class="def">getGhosts</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] <a href="#v:getGhosts" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma lista de players, devolve os que s&#227;o fantasmas</p></div></div><div class="top"><p class="src"><a id="v:updatePlayersGhosts" class="def">updatePlayersGhosts</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:State" title="Types">State</a> <a href="#v:updatePlayersGhosts" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe um estado, uma lista de fantasmas e devolve o estado com os fantasmas trocados na lista</p><pre>if getPlayerID g == getPlayerID p then (State (x:xs) (g:ghostsatt) l)
else (State (x:xs) (p:ghostsatt') l)
</pre><ul><li>Caso o primeiro jogador seja um fantasma, seu estado de jogador &#233; trocado para o que o fantasma fica quando o pacman torna-se Mega e procura-se pelos outros fantasmas no resto da lista</li><li>Caso contr&#225;rio, repete-se o primeiro jogador e procura-se no resto da lista dos jogadores</li></ul></div></div><div class="top"><p class="src"><a id="v:newState" class="def">newState</a> :: <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> <a href="#v:newState" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um estado e um jogador, devolve um novo estado dependendo do modo que este jogador se encontra</p><pre>if pacmanMode == Mega then updatePlayersGhosts newStatePlayer lghosts
else newStatePlayer
</pre><ul><li>Se o pacman estiver em estado Mega, o jogador tem seu estado trocado pelo ap&#243;s a jogada e os ghosts passar&#227;o a estar Dead e com velocidade reduzida para a metade</li><li>Caso contr&#225;rio, apenas o estado do jogador &#233; trocado pelo ap&#243;s a jogada</li></ul><pre>newStatePlayer = updateState (State (x:xs) (p:ps) l) player
</pre><ul><li>Troca o estado do jogador pelo estado novo ap&#243;s a jogada</li></ul><pre>lghosts = ghostDead (getGhosts (p:ps))
</pre><ul><li>Seleciona os fantasmas da lista de jogadores e muda seus estados para Dead e reduz suas velocidades para a metade </li></ul></div></div><div class="top"><p class="src"><a id="v:isitFood" class="def">isitFood</a> :: <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; Bool <a href="#v:isitFood" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:pacPlay" class="def">pacPlay</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> <a href="#v:pacPlay" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o play para jogadas com o pacman</p><pre>if isthereGhost (Move j o) (x:xs) (p:ps) == True then newStateGhost
else newState (State maze (p:ps) l) player
</pre><ul><li>Caso exista fantasma na posi&#231;&#227;o que o pacman deseja ir, ent&#227;o devolve o estado atualizado com os estados dos fantasmas que foram comidos alterados, caso tenha acontecido, com o estado do pacman alterado e com o labirinto alterado caso tenha comido alguma comida</li><li>Caso contr&#225;rio, devolve o estado atualizado com os estados dos fantasmas mudados caso o pacman tenha se tornado Mega, com o estado do pacman atualizado e com o labirinto atualizado caso tenha comido alguma comida</li></ul><pre>player = movePlay (Move j o) (x:xs) (p:ps)
</pre><ul><li>Estado do jogador ap&#243;s efetuar a jogada</li></ul><pre>maze = updateMaze (x:xs) player 
</pre><ul><li>Labirinto atualizado ap&#243;s a jogada </li></ul><pre>coord = getCoords (movePlay (Move j o) (x:xs) (p:ps))
</pre><ul><li>Seleciona as coordenadas do jogador ap&#243;s a jogada</li></ul><pre>ghostNew = stateGhost (x:xs) (findPlayer j (p:ps)) (findPlayerscoord (p:ps) coord) 
</pre><ul><li>Procura se h&#225; fantasmas com a coordenada que o jogador quer ir, procura o pacman na lista de jogadores e atualiza o estado do(s) fantasma(s) consuante o estado do pacman</li></ul><pre>newStateGhost = updatePlayersGhosts (newState (State maze (p:ps) l) player) ghostNew
</pre><ul><li>Recebe o novo estado do jogo apenas com altera&#231;&#227;o do estado do pacman e dos fantasmas caso o pacman esteja <strong>Mega</strong> e o novo estado do(s) fantasma(s) ap&#243;s ter(em) sido comido(s)</li><li>Retorna o novo estado do jogo com o estado do(s) fantasma(s) comido(s) atualizado na lista de jogadores</li></ul><p>Fun&#231;&#227;o para jogada com o Pacman</p></div></div><div class="top"><p class="src"><a id="v:play" class="def">play</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> <a href="#v:play" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o final play</p></div></div><div class="top"><p class="src"><a id="v:playGhost" class="def">playGhost</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> -&gt; <a href="Types.html#t:State" title="Types">State</a> <a href="#v:playGhost" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o para jogada com o Fantasma</p></div></div><div class="top"><p class="src"><a id="v:movePlayGhost" class="def">movePlayGhost</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:movePlayGhost" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dada uma jogada, um labirinto e uma lista de jogadores, devolve o jogador de ID j atualizado</p></div></div><div class="top"><p class="src"><a id="v:moveAfterPacSide" class="def">moveAfterPacSide</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:moveAfterPacSide" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador, um inteiro e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o ao ghost e &#224;s orienta&#231;&#245;es para <strong>esquerda</strong> e <strong>direita</strong></p></div></div><div class="top"><p class="src"><a id="v:moveAfterPacVertical" class="def">moveAfterPacVertical</a> :: <a href="Types.html#t:Play" title="Types">Play</a> -&gt; <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; Int -&gt; <a href="Types.html#t:Orientation" title="Types">Orientation</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:moveAfterPacVertical" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado uma jogada, um labirinto, um jogador, um inteiro e uma orienta&#231;&#227;o, devolve o jogador ap&#243;s a jogada. Esta fun&#231;&#227;o &#233; em rela&#231;&#227;o ao ghost e &#224;s orienta&#231;&#245;es para <strong>cima</strong> e <strong>baixo</strong></p></div></div><div class="top"><p class="src"><a id="v:istherePacman" class="def">istherePacman</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Coords" title="Types">Coords</a> -&gt; Bool <a href="#v:istherePacman" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que confirma se, nas coordenadas onde o jogador pretende ir existe ou n&#227;o um pacman</p></div></div><div class="top"><p class="src"><a id="v:getPacman" class="def">getPacman</a> :: [<a href="Types.html#t:Player" title="Types">Player</a>] -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:getPacman" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que retira da lista de jogadores o player que corresponde ao pacman</p></div></div><div class="top"><p class="src"><a id="v:ghostHome-39-" class="def">ghostHome'</a> :: <a href="Types.html#t:Maze" title="Types">Maze</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:ghostHome-39-" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que move um fantasma comido de volta para a casa dos fantasmas e volta a estar vivo</p></div></div><div class="top"><p class="src"><a id="v:collidePac" class="def">collidePac</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:collidePac" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que quando o pacman colide com um fantasma, decide que, caso o estado do pacman seja Mega, este come o fantasma e ganha 10 pontos, caso contr&#225;rio, se estiver em estado normal, perde uma vida. Se tiver 0 vidas altera o seu estado para Dying.</p></div></div><div class="top"><p class="src"><a id="v:openOrClosed" class="def">openOrClosed</a> :: <a href="Types.html#t:Player" title="Types">Player</a> -&gt; <a href="Types.html#t:Player" title="Types">Player</a> <a href="#v:openOrClosed" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que define a posi&#231;&#227;o da boca do pacman                                                         </p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.23.0</p></div></body></html>